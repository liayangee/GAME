<!DOCTYPE html>

<html lang="zh-TW">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>æ•¸å­—æˆ°å£« - ä¹˜æ³•å¤§æˆ°</title>

    <style>

        * {

            margin: 0;

            padding: 0;

            box-sizing: border-box;

        }

       

        body {

            font-family: 'Arial', sans-serif;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            min-height: 100vh;

            color: white;

        }

       

        .container {

            max-width: 1200px;

            margin: 0 auto;

            padding: 20px;

        }

       

        .header {

            text-align: center;

            margin-bottom: 30px;

        }

       

        .title {

            font-size: 2.5rem;

            font-weight: bold;

            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);

            margin-bottom: 10px;

        }

       

        .subtitle {

            font-size: 1.2rem;

            opacity: 0.9;

        }

       

        .game-controls {

            display: flex;

            justify-content: center;

            gap: 20px;

            margin-bottom: 30px;

            flex-wrap: wrap;

        }

       

        .difficulty-btn {

            padding: 12px 24px;

            border: none;

            border-radius: 25px;

            background: rgba(255,255,255,0.2);

            color: white;

            font-size: 1rem;

            cursor: pointer;

            transition: all 0.3s ease;

            backdrop-filter: blur(10px);

        }

       

        .difficulty-btn:hover {

            background: rgba(255,255,255,0.3);

            transform: translateY(-2px);

        }

       

        .difficulty-btn.active {

            background: #ff6b6b;

            box-shadow: 0 4px 15px rgba(255,107,107,0.4);

        }

       

        .battle-arena {

            background: rgba(255,255,255,0.1);

            border-radius: 20px;

            padding: 30px;

            margin-bottom: 30px;

            backdrop-filter: blur(10px);

            border: 1px solid rgba(255,255,255,0.2);

        }

       

        .problem-display {

            text-align: center;

            font-size: 2rem;

            margin-bottom: 30px;

            font-weight: bold;

        }

       

        .warriors-container {

            display: flex;

            flex-direction: column;

            align-items: center;

            margin-bottom: 30px;

            gap: 20px;

        }

       

        .warrior-group {

            display: flex;

            flex-direction: column;

            align-items: center;

            gap: 10px;

            width: 100%;

        }

       

        .warrior-row {

            display: flex;

            justify-content: center;

            gap: 15px;

            flex-wrap: wrap;

        }

       

        .warrior {

            width: 80px;

            height: 80px;

            border-radius: 50%;

            display: flex;

            align-items: center;

            justify-content: center;

            font-size: 1.5rem;

            font-weight: bold;

            color: white;

            cursor: pointer;

            transition: all 0.3s ease;

            position: relative;

            box-shadow: 0 4px 15px rgba(0,0,0,0.2);

        }

       

        .warrior.hundreds { background: linear-gradient(45deg, #ff6b6b, #ee5a52); }

        .warrior.tens { background: linear-gradient(45deg, #4ecdc4, #44a08d); }

        .warrior.ones { background: linear-gradient(45deg, #45b7d1, #96c93d); }

       

        .warrior:hover {

            transform: scale(1.1);

            box-shadow: 0 6px 20px rgba(0,0,0,0.3);

        }

       

        .warrior.selected {

            animation: pulse 1s infinite;

            border: 3px solid #ffd700;

        }

       

        @keyframes pulse {

            0% { transform: scale(1); }

            50% { transform: scale(1.05); }

            100% { transform: scale(1); }

        }

       

        .vs-symbol {

            font-size: 3rem;

            font-weight: bold;

            color: #ffd700;

            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);

        }

       

        .battle-steps {

            background: rgba(255,255,255,0.1);

            border-radius: 15px;

            padding: 20px;

            margin-bottom: 20px;

        }

       

        .step {

            display: flex;

            justify-content: space-between;

            align-items: center;

            padding: 10px;

            margin: 5px 0;

            border-radius: 10px;

            background: rgba(255,255,255,0.05);

            opacity: 0.5;

            transition: all 0.3s ease;

        }

       

        .step.active {

            opacity: 1;

            background: rgba(255,255,255,0.2);

            transform: translateX(10px);

        }

       

        .step.completed {

            opacity: 1;

            background: rgba(76, 175, 80, 0.3);

        }

       

        .current-step {

            background: rgba(255, 255, 255, 0.15);

            border-radius: 15px;

            padding: 25px;

            margin-bottom: 20px;

            border: 2px solid #ffd700;

        }

       

        .completed-steps {

            background: rgba(76, 175, 80, 0.1);

            border-radius: 15px;

            padding: 20px;

            margin-top: 20px;

        }

       

        .completed-steps h4 {

            color: #00ff88;

            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);

            margin-bottom: 15px;

        }

       

        .final-sum {

            background: rgba(255, 215, 0, 0.1);

            border-radius: 15px;

            padding: 25px;

            border: 2px solid #ffd700;

        }

       

        .answer-section {

            text-align: center;

            margin-top: 20px;

        }

       

        .answer-input {

            padding: 15px 25px;

            font-size: 1.5rem;

            border: none;

            border-radius: 25px;

            text-align: center;

            margin: 0 10px;

            width: 150px;

            background: rgba(255,255,255,0.9);

            color: #333;

        }

       

        .submit-btn {

            padding: 15px 30px;

            font-size: 1.2rem;

            border: none;

            border-radius: 25px;

            background: #4CAF50;

            color: white;

            cursor: pointer;

            transition: all 0.3s ease;

            margin-left: 10px;

        }

       

        .submit-btn:hover {

            background: #45a049;

            transform: translateY(-2px);

        }

       

        .score-board {

            display: flex;

            justify-content: center;

            gap: 30px;

            margin-bottom: 20px;

        }

        

        .score-item {

            text-align: center;

            background: rgba(255,255,255,0.1);

            padding: 15px 25px;

            border-radius: 15px;

            backdrop-filter: blur(10px);

        }

       

        .score-number {

            font-size: 2rem;

            font-weight: bold;

            display: block;

        }

       

        .feedback {

            text-align: center;

            font-size: 1.5rem;

            font-weight: bold;

            margin: 20px 0;

            min-height: 40px;

        }

       

        .correct { color: #00ff88; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }

        .incorrect { color: #ff4444; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }

       

        .instructions {

            background: rgba(255,255,255,0.1);

            border-radius: 15px;

            padding: 20px;

            margin-bottom: 30px;

            backdrop-filter: blur(10px);

        }

       

        .instructions h3 {

            color: #ffd700;

            margin-bottom: 15px;

            text-align: center;

        }

       

        .instructions ul {

            list-style: none;

            padding: 0;

        }

       

        .instructions li {

            margin: 10px 0;

            padding: 10px;

            background: rgba(255,255,255,0.05);

            border-radius: 8px;

            border-left: 4px solid #ffd700;

        }

       

        @media (max-width: 768px) {

            .title { font-size: 2rem; }

            .warriors-container { flex-direction: column; }

            .vs-symbol { font-size: 2rem; }

            .warrior { width: 60px; height: 60px; font-size: 1.2rem; }

            .score-board { flex-direction: column; gap: 15px; }

            .game-controls { gap: 10px; }

            .difficulty-btn { padding: 10px 16px; font-size: 0.9rem; }

        }

    </style>

</head>

<body>

    <div class="container">

        <div class="header">

            <h1 class="title">ğŸ† æ•¸å­—æˆ°å£« - ä¹˜æ³•å¤§æˆ°</h1>

            <p class="subtitle">è®“æ•¸å­—æˆ°å£«å€‘æ•™ä½ ä¹˜æ³•çš„ç§˜å¯†ï¼é©åˆå°å­¸ç”Ÿèˆ‡å®¶é•·ä¸€èµ·äº’å‹•å­¸ç¿’</p>

        </div>

       

        <div class="instructions">

            <h3>ğŸ“š éŠæˆ²èªªæ˜</h3>

            <ul>

                <li>ğŸ¯ <strong>ç›®æ¨™ï¼š</strong>é€éæˆ°å£«å°æˆ°çš„æ–¹å¼ï¼Œå­¸ç¿’å¤šä½æ•¸ä¹˜æ³•çš„åˆ†è§£è¨ˆç®—</li>

                <li>âš”ï¸ <strong>ç©æ³•ï¼š</strong>æ¯å€‹æ•¸å­—çš„ä½æ•¸éƒ½æ˜¯æˆ°å£«ï¼Œä»–å€‘æœƒé€ä¸€å°æˆ°ä¸¦è¨ˆç®—çµæœ</li>

                <li>ğŸ§® <strong>å­¸ç¿’ï¼š</strong>å­©å­å°‡å­¸æœƒå¦‚ä½•å°‡è¤‡é›œçš„ä¹˜æ³•åˆ†è§£æˆç°¡å–®çš„æ­¥é©Ÿ</li>

                <li>ğŸ… <strong>é€²åº¦ï¼š</strong>å¾ç°¡å–®çš„äºŒä½æ•¸Ã—ä¸€ä½æ•¸é–‹å§‹ï¼Œé€æ­¥æŒ‘æˆ°æ›´é›£çš„é¡Œç›®</li>

                <li>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ <strong>è¦ªå­äº’å‹•ï¼š</strong>å®¶é•·å¯ä»¥é™ªä¼´å­©å­ä¸€èµ·è§£é¡Œï¼Œè¨è«–æ¯å€‹æ­¥é©Ÿ</li>

            </ul>

        </div>

       

        <div class="game-controls">

            <button class="difficulty-btn active" onclick="setDifficulty('2x1')">äºŒä½æ•¸ Ã— ä¸€ä½æ•¸</button>

            <button class="difficulty-btn" onclick="setDifficulty('3x1')">ä¸‰ä½æ•¸ Ã— ä¸€ä½æ•¸</button>

            <button class="difficulty-btn" onclick="setDifficulty('2x2')">äºŒä½æ•¸ Ã— äºŒä½æ•¸</button>

            <button class="difficulty-btn" onclick="setDifficulty('3x2')">ä¸‰ä½æ•¸ Ã— äºŒä½æ•¸</button>

            <button class="difficulty-btn" onclick="setDifficulty('2x3')">äºŒä½æ•¸ Ã— ä¸‰ä½æ•¸</button>

        </div>

       

        <div class="score-board">

            <div class="score-item">

                <span class="score-number" id="correct-count">0</span>

                <span>ç­”å°é¡Œæ•¸</span>

            </div>

            <div class="score-item">

                <span class="score-number" id="total-count">0</span>

                <span>ç¸½é¡Œæ•¸</span>

            </div>

            <div class="score-item">

                <span class="score-number" id="accuracy">0%</span>

                <span>æ­£ç¢ºç‡</span>

            </div>

        </div>

       

        <div class="battle-arena">

            <div class="problem-display" id="problem-display">

                é»æ“Šã€Œé–‹å§‹æˆ°é¬¥ã€ä¾†é–‹å§‹éŠæˆ²ï¼

            </div>

           

            <div class="warriors-container" id="warriors-container">

                <!-- æˆ°å£«å€‘æœƒåœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->

            </div>

           

            <div class="battle-steps" id="battle-steps">

                <h3 style="margin-bottom: 15px;">âš”ï¸ æˆ°é¬¥æ­¥é©Ÿï¼š</h3>

                <div id="steps-container">

                    <!-- æ­¥é©Ÿæœƒåœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->

                </div>

            </div>

           

            <div class="answer-section">

                <button class="submit-btn" onclick="newProblem()" style="background: #2196F3; font-size: 1.3rem; padding: 20px 40px;">ğŸš€ é–‹å§‹æ–°æˆ°é¬¥</button>

            </div>

           

            <div class="feedback" id="feedback"></div>

        </div>

       

        <div class="instructions" style="margin-top: 30px;">

            <h3>ğŸ’¡ å®¶é•·æŒ‡å°å»ºè­°</h3>

            <ul>

                <li>ğŸ—£ï¸ <strong>é¼“å‹µæ€è€ƒï¼š</strong>è®“å­©å­èªªå‡ºæ¯ä¸€æ­¥çš„è¨ˆç®—éç¨‹ï¼ŒåŸ¹é¤Šé‚è¼¯æ€ç¶­</li>

                <li>ğŸ‰ <strong>æ­£é¢å›é¥‹ï¼š</strong>ç­”å°æ™‚çµ¦äºˆè®šç¾ï¼Œç­”éŒ¯æ™‚è€å¿ƒè§£é‡‹æ­£ç¢ºæ–¹æ³•</li>

                <li>ğŸ“ <strong>ç­†ç®—ç·´ç¿’ï¼š</strong>å¯ä»¥æº–å‚™ç´™ç­†ï¼Œè®“å­©å­åŒæ™‚ç·´ç¿’ç­†ç®—</li>

                <li>â° <strong>é©åº¦ä¼‘æ¯ï¼š</strong>æ¯æ¬¡éŠæˆ²15-20åˆ†é˜ï¼Œé¿å…ç–²å‹</li>

                <li>ğŸ¯ <strong>å¾ªåºæ¼¸é€²ï¼š</strong>å¾ç°¡å–®é›£åº¦é–‹å§‹ï¼Œé€æ­¥æå‡æŒ‘æˆ°</li>

            </ul>

        </div>

    </div>

 

    <script>

        let currentDifficulty = '2x1';

        let currentProblem = null;

        let currentStep = 0;

        let correctCount = 0;

        let totalCount = 0;

        let selectedWarriors = [];

       

        function setDifficulty(difficulty) {

            currentDifficulty = difficulty;

            document.querySelectorAll('.difficulty-btn').forEach(btn => btn.classList.remove('active'));

            event.target.classList.add('active');

            newProblem();

        }

       

        function generateProblem() {

            let num1, num2;

           

            switch(currentDifficulty) {

                case '2x1':

                    num1 = Math.floor(Math.random() * 90) + 10; // 10-99

                    num2 = Math.floor(Math.random() * 9) + 1;   // 1-9

                    break;

                case '3x1':

                    num1 = Math.floor(Math.random() * 900) + 100; // 100-999

                    num2 = Math.floor(Math.random() * 9) + 1;     // 1-9

                    break;

                case '2x2':

                    num1 = Math.floor(Math.random() * 90) + 10; // 10-99

                    num2 = Math.floor(Math.random() * 90) + 10; // 10-99

                    break;

                case '3x2':

                    num1 = Math.floor(Math.random() * 900) + 100; // 100-999

                    num2 = Math.floor(Math.random() * 90) + 10;   // 10-99

                    break;

                case '2x3':

                    num1 = Math.floor(Math.random() * 90) + 10;   // 10-99

                    num2 = Math.floor(Math.random() * 900) + 100; // 100-999

                    break;

            }

           

            return { num1, num2, answer: num1 * num2 };

        }

       

        function getDigits(num) {

            const str = num.toString();

            const digits = [];

           

            for (let i = str.length - 1; i >= 0; i--) {

                digits.push(parseInt(str[i]));

            }

           

            // è£œé½Šåˆ°ä¸‰ä½æ•¸ [å€‹ä½, åä½, ç™¾ä½]

            while (digits.length < 3) {

                digits.push(0);

            }

           

            return digits;

        }

       

        function createWarriors(num1, num2) {

            const digits1 = getDigits(num1);

            const digits2 = getDigits(num2);

           

            const container = document.getElementById('warriors-container');

            container.innerHTML = '';

           

            // ç¬¬ä¸€å€‹æ•¸å­—çš„æˆ°å£«

            const group1 = document.createElement('div');

            group1.className = 'warrior-group';

            group1.innerHTML = `<h3>${num1}</h3>`;

           

            const warriorRow1 = document.createElement('div');

            warriorRow1.className = 'warrior-row';

           

            const positions = ['ones', 'tens', 'hundreds'];

            const positionNames = ['å€‹ä½', 'åä½', 'ç™¾ä½'];

           

            for (let i = 2; i >= 0; i--) {

                if (digits1[i] > 0 || (i === 0 && num1 > 0)) {

                    const warrior = document.createElement('div');

                    warrior.className = `warrior ${positions[i]}`;

                    warrior.textContent = digits1[i];

                    warrior.title = `${positionNames[i]}: ${digits1[i]}`;

                    warrior.onclick = () => selectWarrior(warrior, 1, i, digits1[i]);

                    warriorRow1.appendChild(warrior);

                }

            }

           

            group1.appendChild(warriorRow1);

           

            // VS ç¬¦è™Ÿ

            const vs = document.createElement('div');

            vs.className = 'vs-symbol';

            vs.textContent = 'âš”ï¸';

            vs.style.margin = '20px 0';

           

            // ç¬¬äºŒå€‹æ•¸å­—çš„æˆ°å£«

            const group2 = document.createElement('div');

            group2.className = 'warrior-group';

            group2.innerHTML = `<h3>${num2}</h3>`;

           

            const warriorRow2 = document.createElement('div');

            warriorRow2.className = 'warrior-row';

           

            for (let i = 2; i >= 0; i--) {

                if (digits2[i] > 0 || (i === 0 && num2 > 0)) {

                    const warrior = document.createElement('div');

                    warrior.className = `warrior ${positions[i]}`;

                    warrior.textContent = digits2[i];

                    warrior.title = `${positionNames[i]}: ${digits2[i]}`;

                    warrior.onclick = () => selectWarrior(warrior, 2, i, digits2[i]);

                    warriorRow2.appendChild(warrior);

                }

            }

           

            group2.appendChild(warriorRow2);

           

            container.appendChild(group1);

            container.appendChild(vs);

            container.appendChild(group2);

        }

       

        function selectWarrior(element, group, position, digit) {

            // ç§»é™¤ä¹‹å‰çš„é¸æ“‡

            document.querySelectorAll('.warrior').forEach(w => w.classList.remove('selected'));

           

            // é¸æ“‡ç•¶å‰æˆ°å£«

            element.classList.add('selected');

            

            // é¡¯ç¤ºé€™å€‹æˆ°å£«çš„æˆ°é¬¥åŠ›

            const positionNames = ['å€‹ä½', 'åä½', 'ç™¾ä½'];

            const feedback = document.getElementById('feedback');

            feedback.innerHTML = `ğŸ—¡ï¸ é¸ä¸­äº†${positionNames[position]}æˆ°å£«ï¼š${digit}`;

            feedback.className = '';

        }

       

        function createBattleSteps(num1, num2) {

            const digits1 = getDigits(num1);

            const digits2 = getDigits(num2);

            const container = document.getElementById('steps-container');

            container.innerHTML = '';

           

            currentProblem.steps = [];

            const positionNames = ['å€‹ä½', 'åä½', 'ç™¾ä½'];

            const multipliers = [1, 10, 100];

           

            // ç”Ÿæˆæ‰€æœ‰æˆ°é¬¥æ­¥é©Ÿ

            for (let i = 0; i < 3; i++) {

                if (digits2[i] > 0) {

                    for (let j = 0; j < 3; j++) {

                        if (digits1[j] > 0) {

                            const value1 = digits1[j] * multipliers[j]; // å¯¦éš›çš„ä½å€¼

                            const value2 = digits2[i] * multipliers[i]; // å¯¦éš›çš„ä½å€¼

                            const result = value1 * value2;

                            currentProblem.steps.push({

                                text: `${positionNames[j]}æˆ°å£«(${value1}) Ã— ${positionNames[i]}æˆ°å£«(${value2})`,

                                calculation: `${value1} Ã— ${value2}`,

                                result: result,

                                value1: value1,

                                value2: value2

                            });

                        }

                    }

                }

            }

           

            // é¡¯ç¤ºç¬¬ä¸€å€‹æ­¥é©Ÿ

            showCurrentStep();

        }

       

        function showCurrentStep() {

            const container = document.getElementById('steps-container');

           

            if (currentStep >= currentProblem.steps.length) {

                // æ‰€æœ‰æ­¥é©Ÿå®Œæˆï¼Œé¡¯ç¤ºæœ€çµ‚åŠ ç¸½

                showFinalSum();

                return;

            }

           

            const step = currentProblem.steps[currentStep];

           

            // å‰µå»ºç›´å¼è¨ˆç®—é¡¯ç¤º

            const verticalCalculation = createVerticalCalculation(step.value1, step.value2);

           

            container.innerHTML = `

                <div class="current-step">

                    <h3>âš”ï¸ ç¬¬ ${currentStep + 1} å›åˆæˆ°é¬¥ï¼š</h3>

                    <div class="step-question">

                        <p style="font-size: 1.3rem; margin: 15px 0;">${step.text}</p>

                        <div class="vertical-calculation">

                            ${verticalCalculation}

                        </div>

                        <div style="margin: 20px 0;">

                            <input type="number" id="step-input" class="answer-input" placeholder="è¼¸å…¥ç­”æ¡ˆ" style="width: 200px;">

                            <button onclick="checkStepAnswer()" class="submit-btn" style="background: #ff6b6b;">ç¢ºèª</button>

                        </div>

                        <div id="step-feedback" class="feedback"></div>

                    </div>

                </div>

                <div class="completed-steps">

                    <h4>âœ… å·²å®Œæˆçš„æˆ°é¬¥ï¼š</h4>

                    ${currentProblem.steps.slice(0, currentStep).map((s, i) =>

                        `<div class="step completed">

                            <span>${s.text}</span>

                            <span style="color: #4CAF50; font-weight: bold;">${s.result}</span>

                        </div>`

                    ).join('')}

                </div>

            `;

           

            // è®“è¼¸å…¥æ¡†ç²å¾—ç„¦é»

            setTimeout(() => {

                const input = document.getElementById('step-input');

                if (input) input.focus();

            }, 100);

        }

       

        function createVerticalCalculation(num1, num2) {

            const num1Str = num1.toString();

            const num2Str = num2.toString();

            const maxLength = Math.max(num1Str.length, num2Str.length);

           

            return `

                <div style="font-family: 'Courier New', monospace; font-size: 2rem; text-align: center; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">

                    <div style="text-align: right; padding: 5px 0;">${num1Str.padStart(maxLength + 2)}</div>

                    <div style="text-align: right; padding: 5px 0; border-bottom: 3px solid #ffd700; margin-bottom: 10px;">Ã— ${num2Str.padStart(maxLength)}</div>

                    <div style="text-align: right; padding: 5px 0; color: #ffd700;">?</div>

                </div>

            `;

        }

       

        function checkStepAnswer() {

            const userAnswer = parseInt(document.getElementById('step-input').value);

            const feedback = document.getElementById('step-feedback');

            const correctAnswer = currentProblem.steps[currentStep].result;

           

            if (isNaN(userAnswer)) {

                feedback.textContent = 'è«‹è¼¸å…¥ä¸€å€‹æ•¸å­—ï¼';

                feedback.className = 'incorrect';

                return;

            }

           

            if (userAnswer === correctAnswer) {

                feedback.textContent = 'ğŸ‰ å¤ªæ£’äº†ï¼é€™ä¸€å›åˆä½ è´äº†ï¼';

                feedback.className = 'correct';

               

                // 1.5ç§’å¾Œé€²å…¥ä¸‹ä¸€æ­¥

                setTimeout(() => {

                    currentStep++;

                    showCurrentStep();

                }, 1500);

            } else {

                feedback.textContent = `âŒ ä¸å°å“¦ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ ${correctAnswer}ã€‚å†è©¦ä¸€æ¬¡ï¼`;

                feedback.className = 'incorrect';

            }

        }

       

        function showFinalSum() {

            const container = document.getElementById('steps-container');

            const totalSum = currentProblem.steps.reduce((sum, step) => sum + step.result, 0);

           

            container.innerHTML = `

                <div class="final-sum">

                    <h3>ğŸ† æœ€çµ‚æ±ºæˆ° - åŠ ç¸½æ‰€æœ‰æˆ°æœï¼š</h3>

                    <div class="completed-steps">

                        ${currentProblem.steps.map((s, i) =>

                            `<div class="step completed">

                                <span>${s.text}</span>

                                <span style="color: #4CAF50; font-weight: bold;">${s.result}</span>

                            </div>`

                        ).join('')}

                    </div>

                    <div style="border-top: 2px solid #ffd700; margin: 20px 0; padding-top: 20px;">

                        <p style="font-size: 1.3rem; margin: 15px 0;">

                            å°‡æ‰€æœ‰æˆ°æœåŠ èµ·ä¾†ï¼š${currentProblem.steps.map(s => s.result).join(' + ')} = ?

                        </p>

                        <div style="margin: 20px 0;">

                            <input type="number" id="final-input" class="answer-input" placeholder="è¼¸å…¥æœ€çµ‚ç­”æ¡ˆ" style="width: 200px;">

                            <button onclick="checkFinalAnswer()" class="submit-btn" style="background: #4CAF50;">å®Œæˆæˆ°é¬¥</button>

                        </div>

                        <div id="final-feedback" class="feedback"></div>

                    </div>

                </div>

            `;

           

            setTimeout(() => {

                const input = document.getElementById('final-input');

                if (input) input.focus();

            }, 100);

        }

       

        function checkFinalAnswer() {

            const userAnswer = parseInt(document.getElementById('final-input').value);

            const feedback = document.getElementById('final-feedback');

           

            if (isNaN(userAnswer)) {

                feedback.textContent = 'è«‹è¼¸å…¥ä¸€å€‹æ•¸å­—ï¼';

                feedback.className = 'incorrect';

                return;

            }

           

            totalCount++;

           

            if (userAnswer === currentProblem.answer) {

                correctCount++;

                feedback.textContent = 'ğŸ‰ğŸ‰ æ­å–œï¼ä½ å®Œå…¨æŒæ¡äº†é€™é“ä¹˜æ³•é¡Œï¼æˆ°å£«å€‘ç‚ºä½ æ­¡å‘¼ï¼';

                feedback.className = 'correct';

            } else {

                feedback.textContent = `âŒ æœ€çµ‚ç­”æ¡ˆä¸å°å“¦ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ ${currentProblem.answer}ã€‚ä¸éä½ å·²ç¶“å¾ˆæ£’äº†ï¼`;

                feedback.className = 'incorrect';

            }

           

            updateScoreBoard();

           

            // 3ç§’å¾Œè‡ªå‹•é–‹å§‹æ–°é¡Œç›®

            setTimeout(() => {

                newProblem();

            }, 3000);

        }

       

        function newProblem() {

            currentProblem = generateProblem();

            currentStep = 0;

            selectedWarriors = [];

           

            document.getElementById('problem-display').textContent =

                `${currentProblem.num1} Ã— ${currentProblem.num2} = ?`;

           

            createWarriors(currentProblem.num1, currentProblem.num2);

            createBattleSteps(currentProblem.num1, currentProblem.num2);

           

            document.getElementById('feedback').textContent = 'æˆ°é¬¥é–‹å§‹ï¼è«‹é€æ­¥å®Œæˆæ¯å€‹æˆ°å£«çš„å°æˆ°ï¼';

            document.getElementById('feedback').className = '';

        }

       

        function updateScoreBoard() {

            document.getElementById('correct-count').textContent = correctCount;

            document.getElementById('total-count').textContent = totalCount;

            document.getElementById('accuracy').textContent =

                totalCount > 0 ? Math.round((correctCount / totalCount) * 100) + '%' : '0%';

        }

       

        // å…è¨±æŒ‰ Enter éµæäº¤ç­”æ¡ˆ

        document.addEventListener('keypress', function(e) {

            if (e.key === 'Enter') {

                const stepInput = document.getElementById('step-input');

                const finalInput = document.getElementById('final-input');

               

                if (stepInput && stepInput === document.activeElement) {

                    checkStepAnswer();

                } else if (finalInput && finalInput === document.activeElement) {

                    checkFinalAnswer();

                }

            }

        });

       

        // åˆå§‹åŒ–éŠæˆ²

        newProblem();

    </script>

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e48cde83edf244',t:'MTc1NzczNDA2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>

</html>
